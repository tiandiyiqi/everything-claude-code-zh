# 变更日志风格指南

本文档定义了项目变更日志的格式规范和翻译原则。

## 格式规范

### 标题格式

```markdown
# v{版本号} - {日期}

例如：# v2.5.0 - 2024-03-15
```

### 分类顺序

变更日志按以下顺序组织：

1. ⚠️ 破坏性变更（BREAKING CHANGES）
2. 🔒 安全（Security）
3. ✨ 新功能（Features）
4. 🔧 改进（Improvements）
5. 🐛 修复（Bug Fixes）
6. ⏪ 回退（Reverts）

### 条目格式

每个变更条目使用以下格式：

```markdown
- **{功能模块}**：{用户友好的描述}
```

示例：
```markdown
- **团队工作空间**：为不同项目创建单独的工作空间。邀请团队成员并保持一切井井有条。
```

如果没有明确的功能模块，可以省略：

```markdown
- 修复了大图片无法上传的问题
```

## 翻译原则

### 1. 技术 → 用户友好

将技术性的提交信息转换为用户能理解的语言。

**技术提交**：
```
feat(auth): add JWT authentication middleware
```

**用户友好翻译**：
```markdown
- **安全登录**：新增安全登录功能，保护您的账户安全
```

**技术提交**：
```
fix(cache): resolve race condition in cache invalidation
```

**用户友好翻译**：
```markdown
- 修复了偶尔出现的数据不同步问题
```

**技术提交**：
```
perf(db): optimize database queries with indexing
```

**用户友好翻译**：
```markdown
- 页面加载速度提升 50%
```

### 2. 突出业务价值

关注用户能感知到的价值，而非技术实现。

❌ **不好**：
```markdown
- 添加了 Redis 缓存层
```

✅ **好**：
```markdown
- 响应速度提升 3 倍
```

❌ **不好**：
```markdown
- 实现了 WebSocket 连接
```

✅ **好**：
```markdown
- 实时更新，无需刷新页面
```

### 3. 用户视角

使用用户视角的语言，避免开发者术语。

**原则**：
- 使用"您"而非"用户"
- 使用主动语态
- 避免技术术语（API、SDK、ORM、middleware 等）
- 关注用户能感知到的变化

❌ **不好**：
```markdown
- 用户现在可以通过 API 导出数据
```

✅ **好**：
```markdown
- 您现在可以导出所有数据到 CSV 文件
```

### 4. 移除技术术语

**需要移除或替换的术语**：
- API → 接口/功能
- SDK → 工具包
- ORM → 数据库
- middleware → 中间层
- refactor → 优化
- implement → 新增/支持
- optimize → 提升/加快
- database query → 数据查询
- cache invalidation → 缓存更新
- race condition → 并发问题

## 破坏性变更处理

破坏性变更需要特别处理，提供清晰的迁移指南。

### 格式

```markdown
## ⚠️ 破坏性变更

- **{功能模块}**：{变更说明}

  **迁移指南**：
  1. {步骤 1}
  2. {步骤 2}
  3. {步骤 3}

  详见文档：{文档链接}
```

### 示例

```markdown
## ⚠️ 破坏性变更

- **API 认证**：所有 API 端点现在需要 Bearer Token 认证。

  **迁移指南**：
  1. 在 API 请求中添加 `Authorization: Bearer <token>` 头
  2. 从 `/auth/token` 端点获取 token
  3. 详见文档：https://docs.example.com/auth

- **配置文件格式**：配置文件从 JSON 迁移到 YAML。

  **迁移指南**：
  1. 运行 `npm run migrate-config` 自动转换
  2. 手动检查转换后的 `config.yml`
  3. 删除旧的 `config.json`
```

### 关键要素

1. **清楚说明影响范围**：哪些功能受影响？
2. **提供迁移指南**：用户需要做什么？
3. **使用警告语气**：让用户意识到重要性
4. **提供文档链接**：详细说明在哪里？

## 安全更新处理

安全相关的提交需要单独列出，但不泄露漏洞细节。

### 格式

```markdown
## 🔒 安全

- {漏洞类型描述}（{CVE 编号}）
- {漏洞类型描述}

**建议立即更新到此版本。**
```

### 示例

```markdown
## 🔒 安全

- 修复了文件上传中的路径遍历漏洞（CVE-2024-1234）
- 加强了 SQL 注入防护
- 更新了依赖项以修复已知漏洞

**建议立即更新到此版本。**
```

### 关键要素

1. **包含 CVE 编号**（如果有）
2. **说明漏洞类型**（但不泄露细节）
3. **建议用户尽快更新**
4. **不要提供漏洞利用方法**

## 完整示例

```markdown
# v2.5.0 - 2024-03-15

## ⚠️ 破坏性变更

- **API 认证**：所有 API 端点现在需要 Bearer Token 认证。

  **迁移指南**：
  1. 在 API 请求中添加 `Authorization: Bearer <token>` 头
  2. 从 `/auth/token` 端点获取 token
  3. 详见文档：https://docs.example.com/auth

## 🔒 安全

- 修复了文件上传中的路径遍历漏洞（CVE-2024-1234）
- 加强了 SQL 注入防护

**建议立即更新到此版本。**

## ✨ 新功能

- **团队工作空间**：为不同项目创建单独的工作空间。邀请团队成员并保持一切井井有条。
- **键盘快捷键**：按 ? 查看所有可用的快捷键。无需触摸鼠标即可更快地导航。
- **深色模式**：保护您的眼睛，在夜间使用更舒适。

## 🔧 改进

- **更快的同步**：文件现在在设备之间的同步速度快 2 倍
- **更好的搜索**：搜索现在包括文件内容，而不仅仅是标题
- **响应速度提升**：页面加载速度提升 50%

## 🐛 修复

- 修复了大图片无法上传的问题
- 解决了预定帖子中的时区混淆
- 更正了通知徽章计数
- 修复了偶尔出现的数据不同步问题
```

## 注意事项

1. **保持简洁**：每个条目 1-2 句话
2. **突出重点**：使用粗体标记功能模块
3. **用户视角**：始终从用户角度描述
4. **避免技术术语**：使用用户能理解的语言
5. **分类清晰**：按类别组织，便于查找
6. **优先级排序**：破坏性变更和安全更新放在最前面
